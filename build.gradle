plugins {
    id 'java'
    id 'org.jetbrains.kotlin.jvm' version '1.3.41'
    id 'antlr'

    id 'application'

    id 'com.stehno.natives' version '0.3.1'

    id "com.github.johnrengelman.shadow" version "4.0.4"
    id 'edu.sc.seis.launch4j' version '2.4.4'
}
apply plugin: 'java'
apply plugin: 'idea'

group 'deflatedpickle'
version '0.4.2-alpha'

sourceCompatibility = 1.8

mainClassName = 'com.deflatedpickle.rawky.MainKt'

sourceSets {
    main.java.srcDirs += "src/main/gen"
}

repositories {
    jcenter()
    mavenCentral()

    maven { url 'http://dl.bintray.com/kotlin/kotlin-eap' }
    maven { url 'https://jitpack.io' }
    maven { url 'http://maven.geotoolkit.org' }
}

dependencies {
    // Kotlin Standard Library
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8"
    implementation "org.jetbrains.kotlin:kotlin-reflect:1.3.41"

    // ANTLR4
    antlr "org.antlr:antlr4:4.7.2"

    // Scripting
    // implementation 'org.jruby:jruby:9.2.7.0'

    // OpenGL
    // compile 'org.lwjgl.lwjgl:lwjgl_util:2.9.3'
    // compile 'org.lwjgl.lwjgl:lwjgl:2.9.3'

    // Widgets
    // implementation 'com.github.cogman:javadocking:1.7.0'
    implementation 'org.dockingframes:docking-frames-common:1.1.1'
    implementation 'org.drjekyll:colorpicker:1.3'
    implementation 'org.swinglabs:swingx:1.6.1'

    implementation 'com.github.DeflatedPickle:WrapLayout:master-SNAPSHOT'

    // Themes
    implementation 'com.github.lkishalmi:Darcula:gradle-SNAPSHOT'
    implementation 'org.pushing-pixels:radiance-substance:2.0.1'
    //nimplementation 'com.github.vincenzopalazzo:material-ui-swing:V1.0.Beta1.4.1'
    implementation 'com.weblookandfeel:weblaf-core:1.2.8'
    implementation 'com.weblookandfeel:weblaf-ui:1.2.8'

    // OBJ Models
    implementation 'de.javagl:obj:0.3.0'

    // File Format
    implementation 'com.google.code.gson:gson:2.8.5'

    // Image Importing/Exporting
    implementation 'javax.media:jai_imageio:1.1'
    implementation 'com.github.dragon66:icafe:c969c07d7b'

    // HTTP
    implementation 'com.github.jkcclemens:khttp:0.1.0'
}

generateGrammarSource {
    outputDirectory = file("src/main/gen/")
}

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

natives {
    configurations = ['compile', 'runtime']
    outputDir = 'natives'
}

run {
    dependsOn includeNatives
    systemProperty 'java.library.path', file('build/natives')
}

jar {
    manifest {
        attributes(
                "Manifest-Version": "1.0",
                "Main-Class": "com.deflatedpickle.rawky.Rawky",
                "Implementation-Vendor": "DeflatedPickle",
                "Implementation-Title": "Rawky",
                "Implementation-Version": "0.4.2-alpha"
        )
    }
}

application {
    mainClassName = 'com.deflatedpickle.rawky.MainKt'
}

shadowJar {
    // minimize()
    archiveName = "Rawky.jar"
}

launch4j {
    mainClassName = 'com.deflatedpickle.rawky.MainKt'
    copyConfigurable = project.tasks.shadowJar.outputs.files
    jar = "lib/${project.tasks.shadowJar.archiveName}"
    outfile = "Rawky.exe"
    outputDir = 'libs'
}